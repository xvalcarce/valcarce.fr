<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="map[name:Xavier Valcarce]">
<meta name="description"
    content="SDP interface and Solver To write LP/SDP in Python I recommend the PICOS interface. It is under the GPLv3 free-license, probably supports your favorite solver, has crucial features for quantum information and, most importantly, has an attentive and firendly developper community.
Regarding SDP solvers, in my experience, nothing compares to MOSEK. Sadly, this solver is proprietary (if price is of your concern, MOSEK offer a free one-year license for students). CVXOPT is a relatively good free-licensed alternative to MOSEK." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/posts/sdppython/" />


<title>
    
    Python - LP/SDP for Quantum Information :: Xavier Valcarce  — Physicist
    
</title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.cf8ace3beedc6917b80a38cba3df1c95b0c39a0c7f61389c93bb3cc3cce41625.css">



<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="theme-color" content="#252627"><meta itemprop="name" content="Python - LP/SDP for Quantum Information">
<meta itemprop="description" content="SDP interface and Solver To write LP/SDP in Python I recommend the PICOS interface. It is under the GPLv3 free-license, probably supports your favorite solver, has crucial features for quantum information and, most importantly, has an attentive and firendly developper community.
Regarding SDP solvers, in my experience, nothing compares to MOSEK. Sadly, this solver is proprietary (if price is of your concern, MOSEK offer a free one-year license for students). CVXOPT is a relatively good free-licensed alternative to MOSEK."><meta itemprop="datePublished" content="2021-02-06T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-02-06T00:00:00+00:00" />
<meta itemprop="wordCount" content="691"><meta itemprop="image" content="/"/>
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/"/>

<meta name="twitter:title" content="Python - LP/SDP for Quantum Information"/>
<meta name="twitter:description" content="SDP interface and Solver To write LP/SDP in Python I recommend the PICOS interface. It is under the GPLv3 free-license, probably supports your favorite solver, has crucial features for quantum information and, most importantly, has an attentive and firendly developper community.
Regarding SDP solvers, in my experience, nothing compares to MOSEK. Sadly, this solver is proprietary (if price is of your concern, MOSEK offer a free one-year license for students). CVXOPT is a relatively good free-licensed alternative to MOSEK."/>




<meta property="article:published_time" content="2021-02-06 00:00:00 &#43;0000 UTC" />







    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">valcarce.fr $ </span>
            <span class="logo__cursor"></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/posts/">Posts</a></li><li><a href="/resume/">Resume</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>4 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title"><a href="/posts/sdppython/">Python - LP/SDP for Quantum Information</a></h1>

            

            <div class="post-content">
                <h2 id="sdp-interface-and-solver">SDP interface and Solver</h2>
<p>To write LP/SDP in Python I recommend the <a href="https://gitlab.com/picos-api/picos">PICOS</a> interface. It is under the GPLv3 free-license, probably supports your favorite solver, has crucial features for quantum information and, most importantly, has an attentive and firendly developper community.</p>
<p>Regarding SDP solvers, in my experience, nothing compares to <a href="https://www.mosek.com">MOSEK</a>. Sadly, this solver is proprietary (if price is of your concern, MOSEK offer a free one-year license for students). <a href="https://cvxopt.org">CVXOPT</a> is a relatively good free-licensed alternative to MOSEK. However, in my experience, CXOPT have memory-leakage issue, bugs when solving complex SDP, and an important optimization time compare to MOSEK.</p>
<h2 id="lp-with-a-membership-problem-local-correlations">LP with a membership problem: Local correlations</h2>
<p>Consider a scenario where a state is shared between <code>N</code> parties, each having <code>m</code> measurement choices (inputs) with <code>d</code> possible results (outputs). The correlations between the parties admit a local hidden-variable model iff the correlations belong to a <a href="https://valcarce.fr/physics/master_thesis.pdf#section.2.2"><em>local polytope</em></a> [1].
To know if correlations of a given scenario are local, it is sufficient to check if these correlations belong, i.e. are &ldquo;inside&rdquo;, the local polytope.</p>
<p>Correlations are in a vector of probability \[p = {p(a_1 \dots a_N|x_1 \dots x_N}\] for all inputs \[x_i\] and output \[a_i \].
The vertices of the local polytope are the derministic strategies <code>p_d</code>, i.e. <code>p</code> is composed of 0s and 1s.
The local polytope can be written as a the set of its vertices <code>L</code>=\[{p_d}\].
Here a simple function that construct the local polytope</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">local_polytope</span>(N,m,d):
    <span style="color:#f1fa8c">&#34;&#34;&#34;Local Polytope generation.
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">    Generate :math:`d^</span><span style="color:#f1fa8c">{m.N}</span><span style="color:#f1fa8c">` vertices of the Local Polytpe for a system with ``N`` partite, each having ``m`` measurement/input and ``d`` output.
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">    Parameters
</span><span style="color:#f1fa8c">    ----------
</span><span style="color:#f1fa8c">    N : int
</span><span style="color:#f1fa8c">        number of partite
</span><span style="color:#f1fa8c">    m : int
</span><span style="color:#f1fa8c">        number of input of one partite
</span><span style="color:#f1fa8c">    d : int
</span><span style="color:#f1fa8c">        number of output of one partite
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">    Returns
</span><span style="color:#f1fa8c">    -------
</span><span style="color:#f1fa8c">    vertices : array_like
</span><span style="color:#f1fa8c">        Polytope. Each row is a vertex (corresponding to a deterministic strategy), each column is the :math:`n^</span><span style="color:#f1fa8c">{th}</span><span style="color:#f1fa8c">` element to that vertice
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">    &#34;&#34;&#34;</span>
    D <span style="color:#ff79c6">=</span> np<span style="color:#ff79c6">.</span>zeros((d<span style="color:#ff79c6">**</span>m,m), dtype<span style="color:#ff79c6">=</span><span style="color:#8be9fd;font-style:italic">int</span>)
    <span style="color:#ff79c6">for</span> _ <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(d<span style="color:#ff79c6">**</span>m):
        D[_][:] <span style="color:#ff79c6">=</span> np<span style="color:#ff79c6">.</span>array(np<span style="color:#ff79c6">.</span>unravel_index(_,(d,)<span style="color:#ff79c6">*</span>m))
    vertices <span style="color:#ff79c6">=</span> np<span style="color:#ff79c6">.</span>zeros(((d<span style="color:#ff79c6">**</span>(m<span style="color:#ff79c6">*</span>N),)<span style="color:#ff79c6">+</span>(m,)<span style="color:#ff79c6">*</span>N<span style="color:#ff79c6">+</span>(d,)<span style="color:#ff79c6">*</span>N))
    c <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
    <span style="color:#ff79c6">for</span> _ <span style="color:#ff79c6">in</span> product(<span style="color:#8be9fd;font-style:italic">range</span>(d<span style="color:#ff79c6">**</span>m), repeat<span style="color:#ff79c6">=</span>N):
        <span style="color:#ff79c6">for</span> x <span style="color:#ff79c6">in</span> product(<span style="color:#8be9fd;font-style:italic">range</span>(m), repeat<span style="color:#ff79c6">=</span>N):
            vertices[(c,)<span style="color:#ff79c6">+</span>x<span style="color:#ff79c6">+</span><span style="color:#8be9fd;font-style:italic">tuple</span>([D[_[i]][x[i]] <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(N)])]<span style="color:#ff79c6">=</span><span style="color:#bd93f9">1</span>
        c <span style="color:#ff79c6">+=</span> <span style="color:#bd93f9">1</span>
    shape <span style="color:#ff79c6">=</span> np<span style="color:#ff79c6">.</span>prod(np<span style="color:#ff79c6">.</span>delete(vertices<span style="color:#ff79c6">.</span>shape[:],<span style="color:#bd93f9">0</span>,<span style="color:#bd93f9">0</span>))
    polytope <span style="color:#ff79c6">=</span> vertices<span style="color:#ff79c6">.</span>reshape(vertices<span style="color:#ff79c6">.</span>shape[<span style="color:#bd93f9">0</span>],shape)
	<span style="color:#ff79c6">return</span> polytope
</code></pre></div><p>A correlation vector <code>p</code> is described by a local model iff <code>p</code> can be written as a convex sum of the local-polytope vertices.
This is a linear programming problem: find a vector <code>v</code> such that <code>v*L=p</code>, with <code>sum(v)=1</code> (convexity) and <code>v&gt;0</code> (each element of <code>v</code> positive).
If <code>v</code> exists then <code>p</code> is compatible with a local model.</p>
<p>For test purpose let&rsquo;s now create a function that returns a local correlation vector <code>p</code>, by construction.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">local_correlation</span>(polytope):
	nb_vertices <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">len</span>(polytope) <span style="color:#6272a4"># Number of vertices composing the polytope</span>
	coeff <span style="color:#ff79c6">=</span> np<span style="color:#ff79c6">.</span>random<span style="color:#ff79c6">.</span>random(nb_vertices) <span style="color:#6272a4"># Random coefficients, one per vertices</span>
	coeff <span style="color:#ff79c6">/=</span> np<span style="color:#ff79c6">.</span>sum(coeff) <span style="color:#6272a4"># Normalised coefficients</span>
	p <span style="color:#ff79c6">=</span> np<span style="color:#ff79c6">.</span>sum([c<span style="color:#ff79c6">*</span>v <span style="color:#ff79c6">for</span> (c,v) <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">zip</span>(coeff,polytope)],axis<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0</span>) <span style="color:#6272a4"># p is a convex sum of the polytopes vertices</span>
	<span style="color:#ff79c6">return</span> p
</code></pre></div><p>Using <code>PICOS</code> we write the linear program</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">is_local</span>(correlation,polytope):
	pb <span style="color:#ff79c6">=</span> pcs<span style="color:#ff79c6">.</span>Problem() <span style="color:#6272a4"># Create a picos Problem instance</span>
	<span style="color:#6272a4"># The two constants of our problem</span>
	L <span style="color:#ff79c6">=</span> pcs<span style="color:#ff79c6">.</span>Constant(<span style="color:#f1fa8c">&#34;L&#34;</span>, polytope)     <span style="color:#6272a4"># local polytope</span>
	p <span style="color:#ff79c6">=</span> pcs<span style="color:#ff79c6">.</span>Constant(<span style="color:#f1fa8c">&#34;p&#34;</span>, correlation)  <span style="color:#6272a4"># correlation vector</span>
	<span style="color:#6272a4"># The variable v (the coefficient of the convex sum)</span>
	dim <span style="color:#ff79c6">=</span> L<span style="color:#ff79c6">.</span>shape[<span style="color:#bd93f9">0</span>]                    <span style="color:#6272a4"># number of vertices</span>
	v <span style="color:#ff79c6">=</span> pcs<span style="color:#ff79c6">.</span>RealVariable(<span style="color:#f1fa8c">&#34;v&#34;</span>, dim)      <span style="color:#6272a4"># v is a real vector with dim element</span>
	<span style="color:#6272a4"># Constraints</span>
	pb<span style="color:#ff79c6">.</span>add_constraint(v <span style="color:#ff79c6">&gt;=</span> <span style="color:#bd93f9">0</span>)           <span style="color:#6272a4"># all elements of v are positive</span>
	pb<span style="color:#ff79c6">.</span>add_constraint(<span style="color:#8be9fd;font-style:italic">sum</span>(v) <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">1</span>)      <span style="color:#6272a4"># sum of elements of v is 1</span>
	pb<span style="color:#ff79c6">.</span>add_constraint(L<span style="color:#ff79c6">.</span>T<span style="color:#ff79c6">*</span>v <span style="color:#ff79c6">==</span> p)       <span style="color:#6272a4"># v is the coefficient of the convex sum of all L vertices</span>
	<span style="color:#6272a4"># Objective</span>
	pb<span style="color:#ff79c6">.</span>set_objective(<span style="color:#f1fa8c">&#34;min&#34;</span>, <span style="color:#bd93f9">1</span> <span style="color:#ff79c6">|</span> v)      <span style="color:#6272a4"># dummy objective</span>

	<span style="color:#6272a4"># Solving the LP</span>
	pb<span style="color:#ff79c6">.</span>solve(solver<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;cvxopt&#34;</span>,primals<span style="color:#ff79c6">=</span><span style="color:#ff79c6">False</span>)
	<span style="color:#ff79c6">if</span> pb<span style="color:#ff79c6">.</span>status <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#34;optimal&#34;</span>:
		<span style="color:#ff79c6">return</span> <span style="color:#ff79c6">True</span>                     <span style="color:#6272a4"># if an optimal solution exists, p belongs to L</span>
	<span style="color:#ff79c6">else</span>:
		<span style="color:#ff79c6">return</span> <span style="color:#ff79c6">False</span>                    <span style="color:#6272a4"># otherwise p is non-local</span>
</code></pre></div><p>Let&rsquo;s verify with two examples</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">L <span style="color:#ff79c6">=</span> local_polytope(<span style="color:#bd93f9">2</span>,<span style="color:#bd93f9">2</span>,<span style="color:#bd93f9">2</span>)
p_l <span style="color:#ff79c6">=</span> local_correlation(L)
p_nl <span style="color:#ff79c6">=</span> L[<span style="color:#bd93f9">1</span>]<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1e-3</span>           <span style="color:#6272a4"># A non local correlation -&gt; we take a vertice and we add 0.01 to each of its elements</span>
<span style="color:#8be9fd;font-style:italic">print</span>(is_local(p_l,L))     <span style="color:#6272a4"># Output True</span>
<span style="color:#8be9fd;font-style:italic">print</span>(is_local(p_nl,L))    <span style="color:#6272a4"># Output False</span>
</code></pre></div><h2 id="complex-sdp-maximize-a-bell-inequality">(Complex) SDP: Maximize a Bell inequality</h2>
<h2 id="refs">Refs</h2>
<p>[1] Pironio S., J. Phys. A: Math. theor. 47 (<a href="https://iopscience.iop.org/article/10.1088/1751-8113/47/42/424020">424020</a>)
[2] Brunner N. et. al., Rev. Mod. Phys. 86, (<a href="https://journals.aps.org/rmp/abstract/10.1103/RevModPhys.86.419">419</a>)</p>

            </div>
        </article>

        <hr />

        <div class="post-info">

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>691 Words</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>6060-02-02 00:60</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h">Read other posts</span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    
                        <span class="button previous">
                            <a href="/posts/dnscrypt/">
                                <span class="button__icon">←</span>
                                <span class="button__text">Setup DNSCrypt with NetworkManager</span>
                            </a>
                        </span>
                    

                    
                        <span class="button next">
                            <a href="/posts/onetimepadjl/">
                                <span class="button__text">Julia - One-Time Pad (XOR)</span>
                                <span class="button__icon">→</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            
            
                <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span><a href="/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
	
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.e9104ec7f3e4b984c7f16d4ae9525f96d56c5cfd1c6eb78b9ddf3d3e675d3b40c222fd229e5ce55d43569e87a05921c5cad0ec1d686dcb09b62bcd77cf7cbe9e.js" integrity="sha512-6RBOx/PkuYTH8W1K6VJfltVsXP0cbreLnd89PmddO0DCIv0inlzlXUNWnoegWSHFytDsHWhtywm2K813z3y&#43;ng=="></script>



<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    </body>
</html>
